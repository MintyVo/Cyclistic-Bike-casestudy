---
title: "Cyclistic Bike Share Casestudy"
author: "Minty Vo"
date: "04/02/2022"
output: html_document
---
*Welcome to my Cyclistic Bike Share data analysis case study*

## Scenario
Cyclistic is the bike-share company with more than 5.800 bikes and 600 docking stations all over Chicago.Lily Moreno, the director of marketing, wants to start a new marketing strategy to convert casual riders into annual members. She believes with the right campaign there is a very good chance of conversion with the company’s name recognition and access to user-friendly bike options. These user-friendly bike options include reclining bikes, hand tricycles, and cargo bikes which makes Cyclistic more inclusive to people with disabilities and riders who can’t use a standard two-wheeled bike. Lily has tasked the marketing analytics team to analyze past user data to find trends and habits of Cyclistic’s users to help create this marketing campaign.

<span style="color: red;">**I will follow these steps of the data analysis process: ask, prepare, process, analyze, share, and act. **</span>

## Ask 

**Business task**

The new marketing strategy requires three components: behavioral differences between annual members and casual riders, reasons why a casual rider would buy Cyclistic annual memberships, and how digital media can influence casual riders to becoming members. The marketing analytics team is tasked with using past user data to find the behavioral differences between annual members and casual riders and report their finding

## Process
**Downloading the data**

 User data from the past 12 months, February 2021 - January 2022 has been made available. Each data set is in csv format and details every ride logged by Cyclistic customers. This data has been made publicly available via license by Motivate International Inc. and the city of Chicago available here. All user’s personal data has been scrubbed for privacy.
 
**Loading packages** 

I am going to install and load some R packages that will help in my analysis

```{r message=FALSE, warning=FALSE}
# install.packages("tidyverse")
# install.packages("lubridate")
# install.packages("dplyr")
# install.packages("ggplot2")
# install.packages("tidyr")
# install.packages("here")
# install.packages("skimr")
# install.packages("janitor")

library(tidyverse)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyr)
library(here)
library(skimr)
library(janitor)
```

Now I import all the dataset on RStudio and  use head(), str() to quickly review the data 

```{r message=FALSE, warning=FALSE}
setwd("/Users/minty/Developer/Cyclistic-Bike-casestudy")
feb2021 <- read_csv("202102-divvy-tripdata.csv")
str(feb2021)
head(feb2021)

mar2021 <- read_csv("202103-divvy-tripdata.csv")
str(mar2021)
head(mar2021)

apr2021 <- read_csv("202104-divvy-tripdata.csv")
str(apr2021)
head(apr2021)

ma2021 <- read_csv("202105-divvy-tripdata.csv")
str(ma2021)
head(ma2021)

jun2021 <- read_csv("202106-divvy-tripdata.csv")
str(jun2021)
head(jun2021)

jul2021 <- read_csv("202107-divvy-tripdata.csv")
str(jul2021)
head(jul2021)

aug2021 <- read_csv("202108-divvy-tripdata.csv")
str(aug2021)
head(aug2021)

sep2021 <- read_csv("202109-divvy-tripdata.csv")
str(sep2021)
head(sep2021)

oct2021 <- read_csv("202110-divvy-tripdata.csv")
str(oct2021)
head(oct2021)

nov2021 <- read_csv("202111-divvy-tripdata.csv")
str(nov2021)
head(nov2021)

dec2021 <- read_csv("202112-divvy-tripdata.csv")
str(dec2021)
head(dec2021)

jan2022 <- read_csv("202201-divvy-tripdata.csv")
str(jan2022)
head(jan2022)
```

Then I combine all the data into one table 

```{r }
bike_data <- rbind(feb2021,mar2021,apr2021,ma2021,jun2021,jul2021,aug2021,sep2021,oct2021,nov2021,dec2021,jan2022)
head(bike_data,10)

``` 

I make a copy of the data to have a backup 

```{r }
bike_data1 <- bike_data
``` 

I add some relevant columns to help me analyze the data easier 
```{r }
#add a date column 
bike_data1$date <- as.Date(bike_data1$started_at)
head(bike_data1$date)

#add a month column
bike_data1$month <- format(as.Date(bike_data1$started_at), "%b_%y") 
head(bike_data1$month)

#add a day column 
bike_data1$day <- format(as.Date(bike_data1$date), "%d")
head(bike_data1$day)

#add a year column
bike_data1$year <- format(as.Date(bike_data1$date), "%Y") 
head(bike_data1$year)

#add a day of week column
bike_data1$weekday <- format(as.Date(bike_data1$date), "%A")
head(bike_data1$weekday)

#add a time started column
bike_data1$time <- format(bike_data1$started_at, format = "%H:%M")
head(bike_data1$time)

#change format for the time column for purposes later
bike_data1$time <- as.POSIXct(bike_data1$time, format = "%H:%M")
head(bike_data1$time)

#calculate ride length in minutes
bike_data1$ride_length <- (as.double(difftime(bike_data1$ended_at, bike_data1$started_at))) /60  
head(bike_data1$ride_length)

``` 
Then I examine the new data frame 
```{r }
str(bike_data1)
colnames(bike_data1)
dim(bike_data1) 
nrow(bike_data1)
summary(bike_data1)
``` 

Now I start to clean the data 
```{r }
#remove duplicates
bike_data1 <- distinct(bike_data1)  

#get rid of negative ride 
bike_data1 <- bike_data1[!bike_data1$ride_length<1,] 
#get rid of the ride that is longer than one day or 1440 mins
bike_data1 <- bike_data1[!bike_data1$ride_length>1440,]

#change a few column names for clarification
bike_data1 <- rename(bike_data1, customer_type = member_casual) 
bike_data1 <- rename(bike_data1, bike_type = rideable_type)

## Filter out data we will not be using and remove missing data
bike_data1 <- bike_data1 %>% select(bike_type, customer_type, started_at, date, month, day, year, weekday, time, ride_length)
drop_na(bike_data1)

remove_empty(bike_data1)

remove_missing(bike_data1) 
``` 

I order data to based on day of week and by month 
```{r }
bike_data1$weekday <- ordered(bike_data1$weekday, levels=c("Monday", "Tuesday", "Wednesday", "Thursday", 
                                                           "Friday", "Saturday", "Sunday"))
bike_data1$month <- ordered(bike_data1$month, levels=c("Feb_21", "Mar_21", "Apr_21",  "May_21", "Jun_21","Jul_21", "Aug_21", "Sep_21", "Oct_21","Nov_21","Dec_21","Jan_2021"))

``` 
## Analyze 

I use the summary() to look at min, max, median, and average ride lengths
```{r }
summary(bike_data1$ride_length)

``` 

I examine the number of customers based on membership types

```{r }
table(bike_data1$customer_type)
``` 

I check the total rides for each customer type in minutes
```{r }
setNames(aggregate(ride_length ~ customer_type, bike_data1, sum), c("customer_type", "total_ride_length(mins)"))

``` 
Then I analyze rides based on customer type

```{r message=FALSE, warning=FALSE}
bike_data1 %>% 
  group_by(customer_type) %>% 
  summarise(min_length = min(ride_length), max_length = max(ride_length), 
            median_length = median(ride_length), mean_length = mean(ride_length))
``` 
I look at ride lengths broken down by day of week and customer type

```{r message=FALSE, warning=FALSE }
aggregate(bike_data1$ride_length ~ bike_data1$customer_type + bike_data1$weekday, FUN = median)

``` 

I arrange total number of rides and averages based on day of week and customer type

```{r message=FALSE, warning=FALSE}
bike_data1 %>% 
  group_by(customer_type, weekday) %>% 
  summarise(total_rides= n(), avg_ride = mean(ride_length)) %>% 
  arrange(weekday)

```

## Share 

The ggplot() function of R Studio was used to create data visualizations that depict patterns and trends found in the data frames.

```{r}
bike_data1 %>%    
  group_by(customer_type, weekday) %>% 
  summarise(number_of_rides = n() ) %>% 
  arrange(customer_type, weekday) %>% 
  ggplot(aes(x = weekday, y = number_of_rides, fill = customer_type)) + geom_col(position = "dodge") + 
  labs(x= 'Day of Week', y='Total Number of Rides', title='Rides per Day of Week', fill = 'Type of Membership') +
  scale_y_continuous(breaks = c(250000, 400000, 550000), labels = c("250K", "400K", "550K"))
```

Figure 1 depicts that casual riders peak on the Saturday and Sunday while members peak Monday through Friday. This indicates members mainly use the bikes for their commutes and not leisure.

```{r}
bike_data1 %>%  
  group_by(customer_type, month) %>%  
  summarise(total_rides = n(),`average_duration_(mins)` = mean(ride_length)) %>% 
  arrange(customer_type) %>% 
  ggplot(aes(x=month, y=total_rides, fill = customer_type)) + geom_col(position = "dodge") + 
  labs(x= "Month", y= "Total Number of Rides", title = "Rides per Month", fill = "Type of Membership") + 
  scale_y_continuous(breaks = c(100000, 200000, 300000, 400000), labels = c("100K", "200K", "300K", "400K")) + theme(axis.text.x = element_text(angle = 45))
```

Figure 2 shows the relationship between customer types and their number of rides during the year.  The summer months bring more riders in total but casual rider usage is nearly nonexistent in the winter months. There are multiple factors which contribute to this result but annual members still use the service at a good rate in those months.


```{r}
bike_data1 %>%   
  group_by(customer_type, weekday) %>% 
  summarise(average_ride_length = mean(ride_length)) %>% 
  ggplot(aes(x=weekday, y = average_ride_length, fill = customer_type))+
  geom_col(position = "dodge") + labs (x="Day of Week", y="Average Ride Length(min)", 
                                       title = "Average Ride Length by Customer Type and Day of Week", 
                                       fill = "Type of Membership") 
```

Figure 3 displays the relationship between the average ride length of each type of customer in each day of the week. The average ride length of casual riders is considerably longer than those of members and peak on Saturday and Sunday. Annual members bike a near constant length regardless of day of week.

```{r}
bike_data1 %>%  
  group_by(customer_type, month) %>% 
  summarise(average_ride_length = mean(ride_length)) %>% 
  ggplot(aes(x=month, y = average_ride_length, fill = customer_type))+ 
  geom_col(position = "dodge") +
  labs (x="Month", y = "Average Ride Length(min)", title = "Average Ride Length by Customer Type and Month", 
        fill = "Type of Membership") + theme(axis.text.x = element_text(angle = 45))
```

Figure 4 illustrates the average ride length by customer type and month. Casual riders have almost double ride length compared to member riders

```{r}
bike_data1 %>%  
  ggplot(aes(x = bike_type, fill = customer_type)) + geom_bar(position = "dodge") + 
  labs(x= 'Bike Type', y='Number of Rentals', title='Bike Type Breakdown', fill = 'Type of Membership') +
  scale_y_continuous(breaks = c(500000, 1000000, 1500000), labels = c("500K", "1Mil", "1.5Mil"))

```

Figure 5 indicates bike type break down. Regarding to the graph, both member and casual rider use classic bike the most. 

```{r}

```
